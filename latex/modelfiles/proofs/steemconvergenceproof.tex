\begin{proof}
  \begin{itemize}
    \item ($\Leftarrow$) Suppose that
    \begin{gather}
      \label{conv:proof:rev}
      \rounds - 1 \geq \left(\postlen - 1\right)\ceil*{\frac{a+b}{\regen}} \\
      \text{and } \forall i \in \left[\playerlen\right], \stpowvec_i = c
      \enspace. \nonumber
    \end{gather}
    Let $\pid \in \left[\playerlen\right]$. In this case it is $\rounds \geq
    \postlen$ and according to \textsc{VoteThisRound} in
    Algorithm~\ref{alg:steem:vote}, $u_{\pid}$ votes non-null in rounds
    $\left(\round_1, \dots, \round_\postlen\right)$ with $r_i = \floor*{\left(i
    - 1\right)\frac{\rounds - 1}{\postlen - 1}} + 1$. Observe that:
    \begin{gather}
      \label{conv:proof:integer}
      \left(\ref{conv:proof:rev}\right) \Rightarrow \frac{\rounds - 1}{\postlen
      - 1} \geq \ceil*{\frac{a+b}{\regen}}
      \underset{\text{integer}}{\overset{\text{rhs}}{\Rightarrow}}
      \floor*{\frac{\rounds - 1}{\postlen - 1}} \geq \ceil*{\frac{a+b}{\regen}}
      \enspace, \\
      \label{conv:proof:step}
      \forall i \in \left[\postlen\right] \setminus \left\{1\right\}, r_i
      \in \left\{r_{i - 1} + \floor*{\frac{\rounds - 1}{\postlen - 1}}, r_{i -
      1} + \ceil*{\frac{\rounds - 1}{\postlen - 1}}\right\} \enspace.
    \end{gather}
    From (\ref{conv:proof:integer}) and (\ref{conv:proof:step}) we have that
    $\forall i \in \left[\postlen - 1\right], r_{i+1} - r_i \geq
    \ceil*{\frac{a+b}{\regen}}$. We will now prove by induction that $\forall i
    \in \left[\postlen\right], \votpowvec_{\pid, r_i} = 1$.

    \begin{itemize}
      \item For $i = 1, \votpowvec_{\pid, 1} = 1$ by
      (Algorithm~\ref{alg:steem:init}, line~\ref{alg:steem:init:vp}).  \item Let
      $\votpowvec_{\pid, r_i} = 1$. Until $r_{i + 1}$, a single non-null vote is
      cast by $u_\pid$, which reduces $\votpowvec_{\pid}$ by at most $a + b$
      (Algorithm~\ref{alg:steem:handlevote},
      line~\ref{alg:steem:handlevote:cost:start}) and at least $\ceil*{\frac{a +
      b}{\regen}}$ regenerations, each of which replenishes $\votpowvec_{\pid}$
      by $\regen$. Thus
      \begin{equation*}
        \votpowvec_{\pid, r_{i + 1}} \geq \min{\left\{\votpowvec_{\pid, r_i} - a
        - b + \regen\ceil*{\frac{a + b}{\regen}}, 1\right\}} \geq 1 \enspace.
      \end{equation*}
      But $\votpowvec_{\pid}$ cannot exceed 1
      (line~\ref{alg:steem:handlevote:regen}), thus $\votpowvec_{\pid, r_{i +
      1}} = 1$.
    \end{itemize}
    Since the above holds for every $\pid \in \left[\playerlen\right]$, we have
    that at the end of the execution, all votes have been cast with full voting
    power, thus $\forall \post = \left(i, \like\right) \in \postlist_\rounds,
    \mathrm{scores}_{p} = c\left(\playerlen b + a \sum\limits_{\pid =
    1}^\playerlen \like_{\pid}\right)$ and the posts in $\postlist_R$ are sorted
    by decreasing score (Algorithm~\ref{alg:steem:handlevote},
    line~\ref{alg:steem:handlevote:order}). We observe that
    \begin{gather*}
      \forall p_1 = \left(j^1, \like^1\right) \neq p_2 = \left(j^2,
      \like^2\right) \in \postlist_R, \idsc{p_1} > \idsc{p_2} \Rightarrow \\
      \sum\limits_{i = 1}^\playerlen \like^1_i > \sum\limits_{i = 1}^\playerlen
      \like^2_i \Rightarrow c\left(\playerlen b + a \sum\limits_{i =
      1}^\playerlen \like^1_i\right) > c\left(\playerlen b + a \sum\limits_{i =
      1}^\playerlen \like^2_i\right) \enspace.
    \end{gather*}
    Thus all posts will be ordered according to their ideal scores; put
    otherwise, $\textsc{IdealScore}^M\left(\postlist_\rounds\right)$ holds.

    \item ($\stpowvec$ variable $\Rightarrow$ no convergence) Let $\postlist =
    \left(\left(1, \left(a_1, \dots, a_\playerlen\right)\right), \left(2,
    \left(b_1, \dots, b_\playerlen\right)\right)\right)$ such that the following
    linear constraints are simultaneously feasible:
    \begin{gather*}
      \sum\limits_{i=1}^\playerlen a_i > \sum\limits_{i=1}^\playerlen b_i \\
      \sum\limits_{i=1}^\playerlen \stpow_i a_i < \sum\limits_{i=1}^\playerlen
      \stpow_i  b_i
    \end{gather*}
    I think that's always possible if $\stpow$ is not constant.

    \item (inequality doesn't hold $\Rightarrow$ no convergence) Suppose that
    \begin{gather}
      \label{conv:proof:fewrounds}
      \rounds - 1 < \left(\postlen - 1\right)\ceil*{\frac{a+b}{\regen}} \\
      \text{and } \forall i \in \left[\playerlen\right], \stpowvec_i = c
      \enspace. \nonumber
    \end{gather}
    If $\rounds < \postlen$ things are easier TODO: prove this.

    Assume $\rounds \geq \postlen$. In this case, all posts receive a vote by
    all players. Consider $\postlist = 1^{\postlen \times \playerlen}, \pid \in
    \left[\playerlen\right]$. Let $i \in \left[\postlen\right]
    :\left(\votpowvecreg_{\pid, r_i} < 1 \wedge \nexists i' < i:
    \votpowvecreg_{\pid, r_{i'}} < 1\right)$, i.e. $i$ is the first round in
    which $u_\pid$ votes with less than full voting power. (Such a round exists
    because of eq.~(\ref{conv:proof:fewrounds}). TODO: prove this) For now
    assume $2 | N$. Let $0 < \gamma < 1$,
    \begin{gather*}
      \postlist = \left[\left(1, \left(1, \dots, 1, \gamma - \epsilon, \dots,
      \gamma - \epsilon\right)\right) \text{ N/2 players full, N/2 less},
      \dots,\right. \\
      \left.\left(1, \left(1, \dots, 1, \gamma - \epsilon, \dots, \gamma -
      \epsilon\right)\right) \text{ i-1 times}, \left(1, \left(\gamma, \dots,
      \gamma, 1, \dots, 1\right)\right)\right.\\
      \left.\text{ N/2 players less, N/2 full},
      \left(1, \left(0, \dots, 0\right)\right), \dots, \left(1, \left(0, \dots,
      0\right)\right)\right]
    \end{gather*}

    ---------------------- Attempt 2

    Let $\postlist = \left[\left(1, \underbrace{\left(1, 0.5 + \epsilon, 0,
    \dots, 0\right)}_{\playerlen}\right), \left(1, \underbrace{\left(0, 0.5, 0,
    \dots, 0\right)}_{\playerlen}\right), \left(1, \underbrace{\left(0, \dots,
    0\right)}_{\playerlen}\right), \dots, \left(1, \underbrace{\left(0, \dots,
    0\right)}_{\playerlen}\right)\right]$. Observe that
    $\idsc{\postlist\left[1\right]} = 1, \idsc{\postlist\left[2\right]} = 1 +
    \epsilon$ and $\forall i \in \left[\postlen\right] \setminus \left\{1,
    2\right\}, \idsc{\postlist\left[i\right]} = 0$, thus $\forall \postlist'$
    that contains the same posts as $\postlist$ and
    $\textsc{Ideal}^1\left(\postlist'\right)$ holds, it is
    $\postlist'\left[1\right] = \postlist\left[2\right]$.

    \begin{itemize}
      \item $\rounds = 1, \attspan = 1$ \\
      In the first round, $u_1$ casts a vote of weight 1 and the rest of the
      players cast a vote of weight 0 for $\postlist\left[1\right]$, thus at the
      end of the execution, $\mathrm{scores}_1 = c \left(a + b\right) +
      \left(\playerlen - 1\right) c b$. No other votes are cast, thus
      $\mathrm{scores}_2 = 0$. Thus at the end of the execution
      $\mathrm{scores}_1 > \mathrm{scores}_2$.

      \item $\rounds = 1, \attspan > 1$ \\
      In the first round, $u_1$ casts a vote of weight 1 for
      $\postlist\left[1\right]$, $u_2$ casts a vote of weight 0.5 for
      $\postlist\left[2\right]$ and all other players cast a vote of weight 0
      for $\postlist\left[1\right]$. No other votes are cast. Thus at the end of
      the execution, $\mathrm{scores}_1 = c\left(a + b\right) + \left(\playerlen
      - 2\right) c b$ and $\mathrm{scores}_2 = c\left(0.5a + b\right)$. We
      deduce that $\mathrm{scores}_1 > \mathrm{scores}_2$.

      \item $\rounds > 1, \attspan = 1$ \\
      In the first round, the votes are identical to the previous case. As we
      saw in eq.~(\ref{conv:proof:step}), the next vote will be cast not earlier
      than round $\ceil*{\frac{\rounds - 1}{\postlen - 1}}$ and not later than
      round $\ceil*{\frac{\rounds - 1}{\postlen - 1}} + 1$, thus
      $\ceil*{\frac{\rounds - 1}{\postlen - 1}} \leq \round_2 \leq
      \ceil*{\frac{\rounds - 1}{\postlen - 1}} + 1 \Rightarrow \votpowvecreg_{1,
      \round_2} \leq \min{\left\{1 - a - b + \regen\ceil*{\frac{\rounds -
      1}{\postlen - 1}}, 1\right\}}$

      \item $\rounds > 1, \attspan > 1$ \\
    \end{itemize}
    In every case, $\postlist_\rounds$ is ordered in descending post score
    (Algorithm~\ref{alg:steem:handlevote},
    line~\ref{alg:steem:handlevote:order}), thus
    $\postlist_\rounds\left[1\right] \neq \postlist\left[2\right]$ and the
    property $\mathrm{Ideal}^1\left(\postlist_\rounds\right)$ does not hold.

    ---------------------------- Attempt 1

    \begin{itemize}
      \item $\rounds < \postlen \wedge \attspan < \postlen$ \\
      At the end of the execution all players will have voted for
      $\postlist\left[1\right]$ in the first round, and thus
      $\mathrm{scores}_{\postlist\left[1\right]} = \playerlen c \left(0.5a +
      b\right)$. On the other hand, $\postlist\left[\postlen\right]$ will have
      been voted by at most $u_\playerlen$ with voting power $\votpow \leq 1 -
      \left(0.5a + b\right) + \regen$, thus \\
      $\mathrm{scores}_{\postlist\left[\postlen\right]} \leq c \left(\left(1 -
      \left(0.5a + b\right) + \regen\right)\left(0.5 + \epsilon\right)a +
      b\right) \overset{\regen < b}{<} c\left(\left(0.5 + \epsilon\right)a +
      b\right)$. Thus $\mathrm{scores}_{\postlist\left[1\right]} >
      \mathrm{scores}_{\postlist\left[\postlen\right]} \Leftrightarrow \left(N
      - 1\right)\left(0.5 + \frac{b}{a}\right) > \epsilon$. TODO: choose
      $\epsilon$ and show non-convergence

      \item $\rounds < \postlen \wedge \attspan = \postlen$ \\
      At the end of the execution, all players except for $u_\playerlen$ will
      have voted for $\postlist\left[1\right]$ in the first round, and thus
      $\mathrm{scores}_{\postlist\left[1\right]} \geq \left(\playerlen -
      1\right) c \left(0.5a + b\right)$. On the other hand,
      $\postlist\left[\postlen\right]$ will have been voted by exactly
      $u_\playerlen$ and this vote will have been cast on the first round, thus
      $\mathrm{scores}_{\postlist\left[\postlen\right]} = c\left(\left(0.5 +
      \epsilon\right)a + b\right)$. Thus
      $\mathrm{scores}_{\postlist\left[1\right]} >
      \mathrm{scores}_{\postlist\left[\postlen\right]} \Leftrightarrow \left(N
      - 2\right)\left(0.5 + \frac{b}{a}\right) > \epsilon$. TODO: choose
      $\epsilon$ and show non-convergence

      \item $\rounds \geq \postlen \wedge \attspan < \postlen$ \\
      In this case, all players vote for all posts.  At the end of the execution
      all players will have voted for $\postlist\left[1\right]$ in the first
      round, and thus $\mathrm{scores}_{\postlist\left[1\right]} = \playerlen c
      \left(0.5a + b\right)$. As far as $\postlist\left[\postlen\right]$ is
      concerned, we first observe that the distance between to voting rounds is
      $\ceil*{\frac{\rounds - 1}{\postlen - 1}}$ at most: $\forall i \in
      \left[M - 1\right], r_{i+1} - r_i \leq \ceil*{\frac{\rounds - 1}{\postlen
      - 1}}$. Thus the voting power of all players will be at most
      $\regen\floor*{\frac{\rounds - 1}{\postlen - 1}}$ before voting for the
      last post. We deduce that
      $\mathrm{scores}_{\postlist\left[\postlen\right]}$
      
      will have
      been voted by all players except for $u_{\playerlen}$ with voting power at
      most

      \item $\rounds \geq \postlen \wedge \attspan = \postlen$ \\
    \end{itemize}

    On the other hand,
    \begin{itemize}
      \item Let $\attspan < M$.
      \begin{itemize}
        \item If $R < M$, then
      \end{itemize}
      the first post $\postlist\left[1\right]$ is voted
      by all players at round 1 and its score becomes $\playerlen c \left(0.5a +
      b\right)$. Given~(\ref{conv:proof:fewrounds}), all subsequent votes are
      cast with voting power strictly less than 1, thus the last post will have
      a score of $\left(\playerlen - 1\right) c \left(0.5a? + b\right) + c
      \left(\left(0.5 + \epsilon\right)a? + b\right)$ at the end of the
      execution.
      \item If $\attspan = M$,
    \end{itemize}
  \end{itemize}
\end{proof}
